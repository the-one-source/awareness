<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Spectrum of Being</title>
<style>
  :root{
    --panel-width:720px; /* fixed panel width (keeps slider consistent) */
    --accent: #4a90e2;
    --bg: #fafafa;
    --card: #ffffff;
    --muted: #666;
    --text: #111;
  }

  html,body{
    height:100%;
    margin:0;
    background:var(--bg);
    font-family: -apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    color:var(--text);
  }

  /* Center page */
  .wrap{
    min-height:100%;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:24px;
  }

  /* Fixed central panel */
  .panel{
    width: min(92%, var(--panel-width));
    max-width: var(--panel-width);
    background:var(--card);
    border-radius:14px;
    box-shadow: 0 10px 30px rgba(20,20,30,0.06);
    padding:34px;
    box-sizing:border-box;
    text-align:center;
  }

  h1{
    margin:0 0 18px 0;
    font-weight:400;
    color:#555;
    font-size:22px;
  }

  /* language select */
  .row{
    display:flex;
    justify-content:center;
    gap:12px;
    align-items:center;
    margin-bottom:20px;
  }
  select{
    padding:8px 12px;
    font-size:15px;
    border-radius:8px;
    border:1px solid #e6e6e6;
    background:white;
  }

  p.lead{
    margin:0 0 18px 0;
    color:#666;
    font-size:15px;
    line-height:1.45;
  }

  /* fixed slider wrapper keeps same width always */
  .fixed-slider-wrap{
    width:100%;
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:6px;
    margin:18px 0 8px 0;
  }

  /* slider visual */
  .fixed-track{
    width:92%;
    max-width:640px; /* ensures slider track aligned with panel text */
  }
  input[type="range"]{
    -webkit-appearance:none;
    width:100%;
    height:12px;
    background:#e6e6e6;
    border-radius:10px;
    outline:none;
    margin:0;
    padding:0;
  }
  input[type="range"]::-webkit-slider-thumb{
    -webkit-appearance:none;
    appearance:none;
    width:30px;
    height:30px;
    border-radius:50%;
    background: var(--accent);
    box-shadow: 0 6px 18px rgba(74,144,226,0.24);
    border:4px solid white; /* pill look */
    margin-top:-9px; /* center thumb vertically on track */
    cursor:pointer;
  }
  input[type="range"]::-moz-range-thumb{
    width:30px;
    height:30px;
    border-radius:50%;
    background: var(--accent);
    box-shadow: 0 6px 18px rgba(74,144,226,0.24);
    border:4px solid white;
    cursor:pointer;
  }

  /* landing labels (only on landing) */
  .slider-labels{
    width:92%;
    max-width:640px;
    display:flex;
    justify-content:space-between;
    color:var(--muted);
    font-size:13px;
    margin-top:8px;
    user-select:none;
  }
  .slider-labels span { opacity:0.95; }

  /* question text */
  #questionText{
    font-size:18px;
    line-height:1.4;
    margin:6px 0 14px 0;
    text-align:center;
    word-break:break-word;
  }

  /* buttons */
  .btn{
    display:inline-block;
    padding:12px 28px;
    border-radius:28px;
    background:linear-gradient(180deg,var(--accent), #2f7fcf);
    color:white;
    border:none;
    font-size:15px;
    cursor:pointer;
    box-shadow: 0 6px 18px rgba(46,119,205,0.18);
    margin-top:18px;
  }
  .btn:active{ transform: translateY(1px); }

  /* result text */
  .result-row{ margin-top:12px; color:#333; font-size:15px; }
  .result-stage{ font-weight:600; margin:6px 0; }

  /* hide containers */
  .hidden { display:none; }

  /* RTL handling for Persian */
  :root[dir="rtl"] .panel { direction:rtl; }
  :root[dir="rtl"] .slider-labels { direction:rtl; }
</style>
</head>
<body>
<div class="wrap">
  <div class="panel" id="panel">

    <h1 id="title">Spectrum of Being</h1>

    <div class="row">
      <select id="langSelect" aria-label="Language">
        <option value="en">English</option>
        <option value="de">Deutsch</option>
        <option value="fa">فارسی</option>
      </select>
    </div>

    <!-- Landing -->
    <div id="landingPane">
      <p class="lead" id="landingText">
        This is a reflection of my inner consciousness called Spectrum of Being. I am answering a series of statements using the slider to indicate my agreement.
      </p>

      <!-- Fixed slider area (same size used later for questionnaire) -->
      <div class="fixed-slider-wrap">
        <div class="fixed-track">
          <input id="landingSlider" type="range" min="0" max="10" value="5" />
        </div>
        <div class="slider-labels" id="landingLabels">
          <span id="lblLeft">Disagree</span>
          <span id="lblMid">Uncertain</span>
          <span id="lblRight">Agree</span>
        </div>
      </div>

      <button id="startBtn" class="btn">Start</button>
    </div>

    <!-- Questionnaire: same fixed slider container used for landing so it won't resize -->
    <div id="questionPane" class="hidden">
      <div id="questionText"></div>

      <div class="fixed-slider-wrap">
        <div class="fixed-track">
          <input id="questionSlider" type="range" min="0" max="10" value="5" />
        </div>
        <!-- no labels under the question slider as requested -->
      </div>

      <button id="nextBtn" class="btn">Next</button>
    </div>

    <!-- Result -->
    <div id="resultPane" class="hidden">
      <div class="result-row">
        <div id="stageI" class="result-stage"></div>
        <div id="stageII" class="result-stage"></div>
        <div id="stageIII" class="result-stage"></div>
      </div>
      <div class="result-row" id="resultText" style="margin-top:18px;"></div>
    </div>

  </div>
</div>

<script>
/* ======= FULL QUESTIONS (English / German / Persian) =======
   Keep these arrays complete. I used the previously provided lists.
   If you ever add new questions, keep the same order across languages.
*/

const QUESTIONS = {
  en: [
    "Life happens to me.",
    "I notice patterns repeating and wonder why.",
    "I was created.",
    "I am questioning creation.",
    "I am the creator.",
    "I need validation to feel seen.",
    "I am validated and seen.",
    "I am validation.",
    "Others exist.",
    "Are others beings?",
    "Others are not beings.",
    "There is someone (something) out there.",
    "Is there anyone out there?",
    "There is no one out there.",
    "I am the victim of life.",
    "I am connected to a source, a higher self or god.",
    "I am the source; god is a concept within me.",
    "Someone has built the wall.",
    "I am a brick in the wall.",
    "I am the wall, shaping the wall constantly.",
    "I blame the society for everything I experience.",
    "I am part of society, therefore I blame myself.",
    "Society arises from me; I blame no one.",
    "Everything is unfair; this world must change.",
    "I must change the world and bring fairness into this.",
    "I radiate fairness; nothing needs to change.",
    "I need to be seen; the world must acknowledge me.",
    "I see myself; there is no need to be seen.",
    "Let there be light — I am projecting the world.",
    "There is god.",
    "There is no god.",
    "God is a concept created by me.",
    "I need to belong to feel whole.",
    "I am not alone; I belong.",
    "I am alone — the only one.",
    "Reality is co-created; I am within a hierarchy and powerless.",
    "Reality is being projected by me.",
    "I am authoring reality; I am the power of all frequencies."
  ],
  de: [
    "Das Leben passiert mir.",
    "Ich bemerke sich wiederholende Muster und frage mich warum.",
    "Ich wurde erschaffen.",
    "Ich hinterfrage die Schöpfung.",
    "Ich bin der Schöpfer.",
    "Ich brauche Bestätigung, um gesehen zu werden.",
    "Ich bin bestätigt und gesehen.",
    "Ich bin die Bestätigung.",
    "Andere existieren.",
    "Sind andere Wesen?",
    "Andere sind keine Wesen.",
    "Da ist jemand (etwas) da draußen.",
    "Gibt es jemanden da draußen?",
    "Da ist niemand da draußen.",
    "Ich bin das Opfer des Lebens.",
    "Ich bin verbunden mit einer Quelle, einem höheren Selbst oder Gott.",
    "Ich bin die Quelle; Gott ist ein Konzept in mir.",
    "Jemand hat die Mauer gebaut.",
    "Ich bin ein Ziegel in der Mauer.",
    "Ich bin die Mauer, die die Mauer ständig formt.",
    "Ich gebe der Gesellschaft die Schuld für alles, was ich erlebe.",
    "Ich bin Teil der Gesellschaft, daher gebe ich mir selbst die Schuld.",
    "Die Gesellschaft entsteht aus mir; ich gebe niemandem die Schuld.",
    "Alles ist unfair; diese Welt muss sich ändern.",
    "Ich muss die Welt verändern und Gerechtigkeit bringen.",
    "Ich strahle Gerechtigkeit aus; nichts muss sich ändern.",
    "Ich muss gesehen werden; die Welt muss mich anerkennen.",
    "Ich sehe mich selbst; es ist nicht nötig, gesehen zu werden.",
    "Es werde Licht — Ich projiziere die Welt.",
    "Es gibt Gott.",
    "Es gibt keinen Gott.",
    "Gott ist ein von mir geschaffenes Konzept.",
    "Ich muss dazugehören, um mich vollständig zu fühlen.",
    "Ich bin nicht allein; ich gehöre dazu.",
    "Ich bin allein — der Einzige.",
    "Realität wird miterschaffen; ich bin innerhalb einer Hierarchie und machtlos.",
    "Die Realität wird von mir projiziert.",
    "Ich erschaffe die Realität; ich bin die Macht aller Frequenzen."
  ],
  fa: [
    "زندگی برای من اتفاق می‌افتد.",
    "من الگوهای تکراری را مشاهده می‌کنم و می‌پرسم چرا.",
    "من خلق شده‌ام.",
    "من در مورد خلقت سؤال می‌کنم.",
    "من خالق هستم.",
    "من برای دیده شدن به تأیید نیاز دارم.",
    "من تأیید و دیده شده‌ام.",
    "من خود تأیید هستم.",
    "دیگران وجود دارند.",
    "آیا دیگران موجود هستند؟",
    "دیگران موجود نیستند.",
    "کسی (چیزی) در بیرون وجود دارد.",
    "آیا کسی در بیرون هست؟",
    "کسی در بیرون وجود ندارد.",
    "من قربانی زندگی هستم.",
    "من به منبع، خود برتر یا خدا متصل هستم.",
    "من منبع هستم؛ خدا یک مفهوم درون من است.",
    "کسی دیوار را ساخته است.",
    "من یک آجر در دیوار هستم.",
    "من دیوار هستم، دیوار را دائماً شکل می‌دهم.",
    "من همه چیز را به جامعه نسبت می‌دهم.",
    "من بخشی از جامعه هستم، بنابراین خودم را مقصر می‌دانم.",
    "جامعه از من بوجود می‌آید؛ من کسی را سرزنش نمی‌کنم.",
    "همه چیز ناعادلانه است؛ این جهان باید تغییر کند.",
    "من باید جهان را تغییر دهم و عدالت بیاورم.",
    "من عدالت می‌تابانم؛ هیچ چیزی نیاز به تغییر ندارد.",
    "من نیاز دارم دیده شوم؛ جهان باید من را ببیند.",
    "من خودم را می‌بینم؛ نیازی به دیده شدن نیست.",
    "بگذار نور باشد — من جهان را خلق می‌کنم.",
    "خدا وجود دارد.",
    "خدا وجود ندارد.",
    "خدا یک مفهوم ساخته‌شده توسط من است.",
    "من نیاز دارم که تعلق داشته باشم تا کامل باشم.",
    "من تنها نیستم؛ من تعلق دارم.",
    "من تنها هستم — تنها یک موجود.",
    "واقعیت هم‌آفرین است؛ من در یک سلسله مراتب و ناتوان هستم.",
    "واقعیت توسط من خلق می‌شود.",
    "من واقعیت را می‌سازم؛ من قدرت تمام فرکانس‌ها هستم."
  ]
};

/* Stage result texts (multi-language). */
const STAGE_TEXT = [
  { en: "My consciousness currently aligns with victimhood, experiencing challenges, learning, and growth is needed.",
    de: "Mein Bewusstsein stimmt derzeit mit Opferbewusstsein überein, Herausforderungen werden erlebt, Lernen und Wachstum sind notwendig.",
    fa: "آگاهی من در حال حاضر با قربانی بودن هماهنگ است؛ تجربهٔ چالش‌ها، نیاز به یادگیری و رشد وجود دارد." },
  { en: "My consciousness currently aligns with realization, observing patterns, questioning, and expanding awareness.",
    de: "Mein Bewusstsein stimmt derzeit mit Erkenntnis überein, beobachtet Muster, hinterfragt und erweitert das Bewusstsein.",
    fa: "آگاهی من در حال حاضر با تحقق هماهنگ است؛ مشاهدهٔ الگوها، پرسشگری و گسترش آگاهی." },
  { en: "My consciousness currently aligns with being, full authorship, source awareness, and deep consciousness.",
    de: "Mein Bewusstsein stimmt derzeit mit Sein, vollständiger Autorenschaft, Quellbewusstsein und tiefem Bewusstsein überein.",
    fa: "آگاهی من در حال حاضر با بودن، خالقیت کامل، آگاهی منبع و آگاهی عمیق هماهنگ است." }
];

/* ------- state ------- */
let lang = "en";
let order = [];        // randomized question order indices
let index = 0;        // which question (0..N-1)
let answers = [];     // numeric answers in order they were asked

/* DOM refs */
const root = document.documentElement;
const langSelect = document.getElementById("langSelect");
const landingPane = document.getElementById("landingPane");
const questionPane = document.getElementById("questionPane");
const resultPane = document.getElementById("resultPane");
const startBtn = document.getElementById("startBtn");
const nextBtn = document.getElementById("nextBtn");
const questionText = document.getElementById("questionText");
const landingSlider = document.getElementById("landingSlider");
const questionSlider = document.getElementById("questionSlider");
const lblLeft = document.getElementById("lblLeft");
const lblMid  = document.getElementById("lblMid");
const lblRight = document.getElementById("lblRight");
const stageIEl = document.getElementById("stageI");
const stageIIEl = document.getElementById("stageII");
const stageIIIEl = document.getElementById("stageIII");
const resultTextEl = document.getElementById("resultText");

/* Initialize UI texts for languages */
function applyLanguage(l){
  lang = l;
  // direction for Persian
  if(lang === "fa"){
    root.setAttribute("dir","rtl");
  } else {
    root.setAttribute("dir","ltr");
  }

  // title
  const title = document.getElementById("title");
  title.textContent = (lang==="en" ? "Spectrum of Being" : lang==="de" ? "Spektrum des Seins" : "طیف هستی");

  // landing description
  const desc = {
    en: "This is a reflection of my inner consciousness called Spectrum of Being. I am answering a series of statements using the slider to indicate my agreement.",
    de: "Dies ist eine Reflexion meines inneren Bewusstseins, genannt Spektrum des Seins. Ich beantworte eine Reihe von Aussagen mit dem Schieberegler.",
    fa: "این بازتابی از آگاهی درونی من به نام طیف هستی است. من به مجموعه‌ای از جملات پاسخ می‌دهم و با استفاده از نوار لغزنده میزان موافقت را مشخص می‌کنم."
  }[lang];
  document.getElementById("landingText").textContent = desc;

  // landing labels
  const labels = {
    en:["Disagree","Uncertain","Agree"],
    de:["Ablehnen","Unentschieden","Zustimmen"],
    fa:["مخالف","نامطمئن","موافق"]
  }[lang];
  lblLeft.textContent = labels[0];
  lblMid.textContent  = labels[1];
  lblRight.textContent = labels[2];

  // Start/Next button words
  startBtn.textContent = (lang==="en" ? "Start" : lang==="de" ? "Start" : "شروع");
  nextBtn.textContent  = (lang==="en" ? "Next" : lang==="de" ? "Weiter" : "بعدی");

  // ensure question text centered
  questionText.style.textAlign = "center";
}

/* Randomize order (Fisher-Yates) */
function makeOrder(n){
  const arr = Array.from({length:n}, (_,i)=>i);
  for(let i=n-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

/* Start test */
startBtn.addEventListener("click", ()=>{
  // randomize question order per session
  order = makeOrder(QUESTIONS[lang].length);
  index = 0;
  answers = [];
  landingPane.classList.add("hidden");
  resultPane.classList.add("hidden");
  questionPane.classList.remove("hidden");
  showCurrentQuestion();
});

/* Show question given index in 'order' */
function showCurrentQuestion(){
  // set fixed slider to center
  questionSlider.value = 5;
  // pick question text by randomized order
  const qidx = order[index];
  const text = QUESTIONS[lang][qidx];
  questionText.textContent = text;
  // center alignment regardless of language
  questionText.style.textAlign = "center";
}

/* Next */
nextBtn.addEventListener("click", ()=>{
  // read slider
  const v = Number(questionSlider.value || 5);
  answers.push(v);
  index++;
  if(index < order.length){
    showCurrentQuestion();
  } else {
    // finished
    questionPane.classList.add("hidden");
    showResult();
  }
});

/* Result calculation: compute sums per stage and show only highest stage message */
function showResult(){
  // For mapping answers into stages we use the original conceptual grouping: 
  // split the randomized order results into 3 equal chunks by the *original* question grouping is not trivial after shuffle.
  // We will compute stage score by mapping each original question index to its stage:
  // from the original arrangement earlier, we grouped questions in blocks:
  // The original English list is 38 items; you previously wanted equal-ish stage groups.
  // For robustness: we'll compute stage assignment by original question index:
  // - Stage I: indices 0..(N/3-1)
  // - Stage II: indices N/3 .. 2N/3-1
  // - Stage III: indices 2N/3 .. N-1
  const N = QUESTIONS[lang].length;
  const chunk = Math.floor(N/3);
  let sscore = [0,0,0];
  // answers array are values in order of 'order' indices
  for(let i=0;i<order.length;i++){
    const originalIdx = order[i];
    const val = answers[i] || 0;
    let stageIndex;
    if(originalIdx < chunk) stageIndex = 0;
    else if(originalIdx < 2*chunk) stageIndex = 1;
    else stageIndex = 2;
    sscore[stageIndex] += val;
  }

  // compute average per stage (divide by number of questions in that stage)
  const counts = [chunk, chunk, N - 2*chunk]; // last chunk may be larger if not divisible
  const avg = [
    counts[0] ? (sscore[0]/counts[0]) : 0,
    counts[1] ? (sscore[1]/counts[1]) : 0,
    counts[2] ? (sscore[2]/counts[2]) : 0
  ];

  // display numeric stage scores (rounded to 1 decimal)
  stageIEl.textContent = "Stage I: " + avg[0].toFixed(1);
  stageIIEl.textContent = "Stage II: " + avg[1].toFixed(1);
  stageIIIEl.textContent = "Stage III: " + avg[2].toFixed(1);

  // pick highest
  let highest = 0;
  if(avg[1] > avg[highest]) highest = 1;
  if(avg[2] > avg[highest]) highest = 2;

  // show only highest-stage text
  resultTextEl.textContent = STAGE_TEXT[highest][lang];

  // show result pane
  resultPane.classList.remove("hidden");
}

/* Language change handling */
langSelect.addEventListener("change", (e)=>{
  applyLanguage(e.target.value);
  // ensure slider at center
  landingSlider.value = 5;
  questionSlider.value = 5;
});

/* initial */
applyLanguage("en");
landingSlider.value = 5;
questionSlider.value = 5;
</script>
</body>
</html>
