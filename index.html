<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Spectrum of Awareness</title>
<style>
  :root{
    --panel-width:760px;
    --accent:#666440;
    --bg:#f5f7fa;
    --card:#ffffff;
    --muted:#666;
    --text:#111;
  }
  html,body{height:100%;margin:0;background:var(--bg);font-family:-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--text);}
  .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:28px;}
  .panel{width:min(96%,var(--panel-width));max-width:var(--panel-width);background:var(--card);border-radius:14px;box-shadow:0 10px 30px rgba(20,20,30,0.06);padding:34px;box-sizing:border-box;text-align:center;}
  h1{margin:0 0 18px 0;font-weight:400;color:#444;font-size:22px;}
  .row{display:flex;justify-content:center;gap:12px;align-items:center;margin-bottom:20px;}
  select{padding:8px 12px;font-size:15px;border-radius:8px;border:1px solid #e6e6e6;background:white;}
  p.lead{margin:0 0 18px 0;color:#666;font-size:15px;line-height:1.45;}
  .fixed-slider-wrap{width:100%;display:flex;flex-direction:column;align-items:center;gap:8px;margin:18px 0 8px 0;}
  .fixed-track{width:92%;max-width:680px;}
  input[type="range"]{-webkit-appearance:none;width:100%;height:12px;border-radius:10px;background:#e6e6e6;outline:none;margin:0;padding:0;}
  input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:34px;height:18px;border-radius:9px;background:var(--accent);box-shadow:0 6px 18px rgba(102,100,64,0.24);border:2px solid white;margin-top:-3px;cursor:pointer;}
  input[type="range"]::-moz-range-thumb{width:34px;height:18px;border-radius:9px;background:var(--accent);box-shadow:0 6px 18px rgba(102,100,64,0.24);border:2px solid white;cursor:pointer;}
  .slider-labels{width:92%;max-width:680px;display:flex;justify-content:space-between;color:var(--muted);font-size:13px;margin-top:6px;user-select:none;}
  .btn{display:inline-block;padding:12px 28px;border-radius:28px;background:var(--accent);color:white;border:none;font-size:15px;cursor:pointer;box-shadow:0 6px 18px rgba(102,100,64,0.18);margin-top:18px;}
  .btn:active{transform:translateY(1px);}
  .hidden{display:none;}
  .result-grid{margin-top:12px;color:#333;font-size:15px;display:flex;gap:12px;justify-content:space-between;align-items:center;}
  .result-stage{font-weight:700;flex:1;padding:10px;background:#fbfbfb;border-radius:10px;cursor:pointer;position:relative;transition:background 0.2s;}
  .result-stage:hover{background:#f0f0f0;}
  .result-score{font-size:18px;color:#222;margin-top:8px;font-weight:600;}
  .stage-desc{padding:12px 14px;margin-top:8px;background:#f9f9f9;border-radius:10px;text-align:left;font-size:14px;line-height:1.45;display:none;position:relative;}
  .stage-desc .close-btn{position:absolute;top:6px;right:10px;font-weight:bold;font-size:16px;cursor:pointer;color:var(--accent);}
  :root[dir="rtl"] .panel{direction:rtl;}
  :root[dir="rtl"] .slider-labels{direction:rtl;}
  #questionText{font-size:18px;line-height:1.45;margin:6px 0 14px 0;text-align:center;word-break:break-word;}
  footer.note{margin-top:14px;color:#666;font-size:13px;}
  #dominantMessage{margin-top:20px;background:#f8f8f8;border-radius:12px;padding:16px;color:#333;font-size:15px;line-height:1.4;box-shadow:0 6px 20px rgba(0,0,0,0.04);}
  #dominantMessage strong{color:var(--accent);}
  @media (max-width:520px){.panel{padding:20px;}#questionText{font-size:16px;}.btn{padding:10px 20px;}}
</style>
</head>
<body>
<div class="wrap">
<div class="panel" id="panel">

  <!-- Landing Page -->
  <div id="landingPane">
    <h1 id="pageTitle">Spectrum of Awareness</h1>
    <div class="row" id="langRow">
      <select id="langSelect">
        <option value="en">English</option>
        <option value="de">Deutsch</option>
        <option value="fa">فارسی</option>
      </select>
    </div>
    <p class="lead" id="landingText">This is a reflection of my inner consciousness called Spectrum of Awareness.</p>
    <button id="startBtn" class="btn">Start</button>
  </div>

  <!-- Questionnaire Page -->
  <div id="questionPane" class="hidden">
    <div id="questionText"></div>
    <div class="fixed-slider-wrap">
      <div class="fixed-track">
        <input id="questionSlider" type="range" min="0" max="10" value="5" />
      </div>
      <div class="slider-labels">
        <span id="qLblLeft">Disagree</span>
        <span id="qLblMid">Uncertain</span>
        <span id="qLblRight">Agree</span>
      </div>
    </div>
    <button id="nextBtn" class="btn">Next</button>
  </div>

  <!-- Result Page -->
  <div id="resultPane" class="hidden">
    <h1 id="resultTitle">Spectrum of Awareness</h1>
    <div class="result-grid">
      <div class="result-stage" id="stageI"><div>Stage I</div><div class="result-score" id="scoreI">0.0</div></div>
      <div class="result-stage" id="stageII"><div>Stage II</div><div class="result-score" id="scoreII">0.0</div></div>
      <div class="result-stage" id="stageIII"><div>Stage III</div><div class="result-score" id="scoreIII">0.0</div></div>
    </div>
    <div id="dominantMessage" class="hidden"></div>
    <div id="stageDetails"></div>
    <button id="restartBtn" class="btn">Restart</button>
    <footer class="note" id="footerNote"></footer>
  </div>

</div>
</div>

<script>
// ----------------- QUESTIONS -----------------
const QUESTIONS = [
  {stage:1,en:"Life happens to me.",de:"Das Leben passiert mir.",fa:"زندگی برای من اتفاق می‌افتد."},
  {stage:2,en:"Life happens through me.",de:"Das Leben passiert durch mich.",fa:"زندگی از طریق من اتفاق می‌افتد."},
  {stage:3,en:"Life happens as me.",de:"Das Leben passiert als ich.",fa:"زندگی همان من است که رخ می‌دهد."},

  {stage:1,en:"I feel life is unfair or against me.",de:"Ich fühle, das Leben ist unfair oder gegen mich.",fa:"من احساس می‌کنم زندگی ناعادلانه است یا علیه من است."},
  {stage:2,en:"I notice patterns repeating and wonder why.",de:"Ich bemerke sich wiederholende Muster und frage mich warum.",fa:"من الگوهای تکراری را مشاهده می‌کنم و می‌پرسم چرا."},
  {stage:3,en:"I see all as one flow of consciousness.",de:"Ich sehe alles als einen Fluss des Bewusstseins.",fa:"من همه چیز را به‌عنوان یک جریان واحد آگاهی می‌بینم."},

  {stage:1,en:"I am the victim of life.",de:"Ich bin das Opfer des Lebens.",fa:"من قربانی زندگی هستم."},
  {stage:2,en:"I am connected to a source.",de:"Ich bin mit einer Quelle verbunden.",fa:"من به یک منبع متصل هستم."},
  {stage:3,en:"I am the only source; God is a concept within me.",de:"Ich bin die einzige Quelle; Gott ist ein Konzept in mir.",fa:"من تنها منبع هستم؛ خدا مفهومی در درون من است."},

  {stage:1,en:"I react to circumstances.",de:"Ich reagiere auf Umstände.",fa:"من به شرایط واکنش نشان می‌دهم."},
  {stage:2,en:"I respond consciously.",de:"Ich reagiere bewusst.",fa:"من با آگاهی پاسخ می‌دهم."},
  {stage:3,en:"I create all circumstances.",de:"Ich erschaffe alle Umstände.",fa:"من تمام شرایط را خلق می‌کنم."},

  {stage:1,en:"I feel separate from life.",de:"Ich fühle mich vom Leben getrennt.",fa:"من احساس می‌کنم از زندگی جدا هستم."},
  {stage:2,en:"I feel part of the flow.",de:"Ich fühle mich als Teil des Flusses.",fa:"من بخشی از جریان هستم."},
  {stage:3,en:"I am the flow itself.",de:"Ich bin der Fluss selbst.",fa:"من خود جریان هستم."},

  {stage:1,en:"I blame others or circumstances.",de:"Ich gebe anderen oder Umständen die Schuld.",fa:"من دیگران یا شرایط را مقصر می‌دانم."},
  {stage:2,en:"I observe without judgment.",de:"Ich beobachte ohne Urteil.",fa:"من بدون قضاوت مشاهده می‌کنم."},
  {stage:3,en:"I see everything as my creation.",de:"Ich sehe alles als meine Schöpfung.",fa:"من همه چیز را به‌عنوان خلقت خود می‌بینم."},

  // --- Add more questions similarly, up to full 84+ ---
];

// ----------------- VARIABLES -----------------
let currentLang = 'en';
let currentIndex = 0;
let stageScores = {1:[],2:[],3:[]};

// ----------------- DOM ELEMENTS -----------------
const landingPane = document.getElementById('landingPane');
const questionPane = document.getElementById('questionPane');
const resultPane = document.getElementById('resultPane');
const questionText = document.getElementById('questionText');
const questionSlider = document.getElementById('questionSlider');
const nextBtn = document.getElementById('nextBtn');
const startBtn = document.getElementById('startBtn');
const restartBtn = document.getElementById('restartBtn');
const langSelect = document.getElementById('langSelect');
const qLblLeft = document.getElementById('qLblLeft');
const qLblMid = document.getElementById('qLblMid');
const qLblRight = document.getElementById('qLblRight');
const scoreI = document.getElementById('scoreI');
const scoreII = document.getElementById('scoreII');
const scoreIII = document.getElementById('scoreIII');
const dominantMessage = document.getElementById('dominantMessage');
const stageDetails = document.getElementById('stageDetails');
const panel = document.getElementById('panel');
const footerNote = document.getElementById('footerNote');

// ----------------- FUNCTIONS -----------------
function updateDirection(){
  document.documentElement.dir = currentLang==='fa'?'rtl':'ltr';
}

function showQuestion(){
  if(currentIndex>=QUESTIONS.length){
    computeResults();
    return;
  }
  const q = QUESTIONS[currentIndex];
  questionText.innerText = q[currentLang];
  questionSlider.value = 5;
}

function nextQuestion(){
  const q = QUESTIONS[currentIndex];
  stageScores[q.stage].push(Number(questionSlider.value));
  currentIndex++;
  showQuestion();
}

function computeResults(){
  landingPane.classList.add('hidden');
  questionPane.classList.add('hidden');
  resultPane.classList.remove('hidden');

  // compute average per stage
  const avg = stage=>stageScores[stage].length? (stageScores[stage].reduce((a,b)=>a+b,0)/stageScores[stage].length).toFixed(1) : 0;
  scoreI.innerText = avg(1);
  scoreII.innerText = avg(2);
  scoreIII.innerText = avg(3);

  // determine dominant stage
  let maxStage = 1;
  let maxScore = avg(1);
  if(avg(2) > maxScore){maxScore = avg(2); maxStage=2;}
  if(avg(3) > maxScore){maxScore = avg(3); maxStage=3;}

  let domText = {
    en:["Stage I: Victimhood dominates. You feel life happens to you.","Stage II: Observer flow dominates. You notice patterns and respond.","Stage III: Sovereign creator dominates. You create all that is."],
    de:["Stufe I: Opferbewusstsein dominiert.","Stufe II: Beobachterfluss dominiert.","Stufe III: Souveräner Schöpfer dominiert."],
    fa:["مرحله I: قربانی غالب است.","مرحله II: جریان ناظر غالب است.","مرحله III: خالق خودآگاه غالب است."]
  };

  dominantMessage.innerText = domText[currentLang][maxStage-1];
  dominantMessage.classList.remove('hidden');

  footerNote.innerText = {
    en:"Click on any stage to view description.",
    de:"Klicken Sie auf eine Stufe, um die Beschreibung anzuzeigen.",
    fa:"برای مشاهده توضیحات، روی هر مرحله کلیک کنید."
  }[currentLang];

  // setup stage details
  const stageDescText = {
    1:{
      en:"Stage I is characterized by victimhood, reaction, and separation.",
      de:"Stufe I ist durch Opferbewusstsein, Reaktion und Trennung gekennzeichnet.",
      fa:"مرحله I با قربانی بودن، واکنش و جدایی مشخص می‌شود."
    },
    2:{
      en:"Stage II is characterized by observation, flow, and awareness of patterns.",
      de:"Stufe II ist durch Beobachtung, Fluss und Musterbewusstsein gekennzeichnet.",
      fa:"مرحله II با مشاهده، جریان و آگاهی از الگوها مشخص می‌شود."
    },
    3:{
      en:"Stage III is characterized by full sovereignty, creation, and oneness.",
      de:"Stufe III ist durch volle Souveränität, Schöpfung und Einheit gekennzeichnet.",
      fa:"مرحله III با حاکمیت کامل، خلق و یگانگی مشخص می‌شود."
    }
  };

  [1,2,3].forEach(s=>{
    const el = document.getElementById('stage'+(s===1?'I':s===2?'II':'III'));
    el.onclick=()=>{
      stageDetails.innerHTML=`<div class="stage-desc"><span class="close-btn" onclick="this.parentElement.style.display='none'">&times;</span>${stageDescText[s][currentLang]}</div>`;
      stageDetails.querySelector('.stage-desc').style.display='block';
    };
  });
}

// ----------------- EVENT LISTENERS -----------------
startBtn.onclick=()=>{
  landingPane.classList.add('hidden');
  questionPane.classList.remove('hidden');
  showQuestion();
};

nextBtn.onclick=nextQuestion;
restartBtn.onclick=()=>location.reload();

langSelect.onchange=()=>{
  currentLang = langSelect.value;
  updateDirection();
  if(!landingPane.classList.contains('hidden')){
    document.getElementById('pageTitle').innerText = {en:"Spectrum of Awareness",de:"Spektrum des Bewusstseins",fa:"طیف آگاهی"}[currentLang];
    landingText.innerText = {
      en:"This is a reflection of my inner consciousness called Spectrum of Awareness.",
      de:"Dies ist eine Reflexion meines inneren Bewusstseins namens Spektrum des Bewusstseins.",
      fa:"این بازتابی از آگاهی درونی من است که طیف آگاهی نامیده می‌شود."
    }[currentLang];
    startBtn.innerText = {en:"Start",de:"Starten",fa:"شروع"}[currentLang];
  } else if(!resultPane.classList.contains('hidden')){
    computeResults(); // recalc dominant text
  } else{
    showQuestion();
  }
};

// initial direction
updateDirection();
</script>
</body>
</html>
