<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Spectrum of Awareness</title>
<style>
  :root{
    --panel-width:760px;
    --accent:#666440;
    --bg:#f5f7fa;
    --card:#ffffff;
    --muted:#666;
    --text:#111;
  }
  html,body{height:100%;margin:0;background:var(--bg);font-family:-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--text);}
  .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:28px;}
  .panel{width:min(96%,var(--panel-width));max-width:var(--panel-width);background:var(--card);border-radius:14px;box-shadow:0 10px 30px rgba(20,20,30,0.06);padding:34px;box-sizing:border-box;text-align:center;}
  h1{margin:0 0 18px 0;font-weight:400;color:#444;font-size:22px;}
  .row{display:flex;justify-content:center;gap:12px;align-items:center;margin-bottom:20px;}
  select{padding:8px 12px;font-size:15px;border-radius:8px;border:1px solid #e6e6e6;background:white;}
  p.lead{margin:0 0 18px 0;color:#666;font-size:15px;line-height:1.45;}
  .fixed-slider-wrap{width:100%;display:flex;flex-direction:column;align-items:center;gap:8px;margin:18px 0 8px 0;}
  .fixed-track{width:92%;max-width:680px;}
  input[type="range"]{-webkit-appearance:none;width:100%;height:12px;border-radius:10px;background:#e6e6e6;outline:none;margin:0;padding:0;}
  input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:34px;height:18px;border-radius:9px;background:var(--accent);box-shadow:0 6px 18px rgba(102,100,64,0.24);border:2px solid white;margin-top:-3px;cursor:pointer;}
  input[type="range"]::-moz-range-thumb{width:34px;height:18px;border-radius:9px;background:var(--accent);box-shadow:0 6px 18px rgba(102,100,64,0.24);border:2px solid white;cursor:pointer;}
  .slider-labels{width:92%;max-width:680px;display:flex;justify-content:space-between;color:var(--muted);font-size:13px;margin-top:6px;user-select:none;}
  .btn{display:inline-block;padding:12px 28px;border-radius:28px;background:var(--accent);color:white;border:none;font-size:15px;cursor:pointer;box-shadow:0 6px 18px rgba(102,100,64,0.18);margin-top:18px;}
  .btn:active{transform:translateY(1px);}
  .question-container{width:100%;}
  .result-grid{margin-top:12px;color:#333;font-size:15px;display:flex;gap:12px;justify-content:space-between;align-items:center;}
  .result-stage{font-weight:700;flex:1;padding:10px;background:#fbfbfb;border-radius:10px;cursor:pointer;position:relative;transition:background 0.2s;}
  .result-stage:hover{background:#f0f0f0;}
  .result-score{font-size:18px;color:#222;margin-top:8px;font-weight:600;}
  .hidden{display:none;}
  .stage-desc{padding:12px 14px;margin-top:8px;background:#f9f9f9;border-radius:10px;text-align:left;font-size:14px;line-height:1.45;display:none;position:relative;}
  .stage-desc .close-btn{position:absolute;top:6px;right:10px;font-weight:bold;font-size:16px;cursor:pointer;color:var(--accent);}
  :root[dir="rtl"] .panel{direction:rtl;}
  :root[dir="rtl"] .slider-labels{direction:rtl;}
  #questionText{font-size:18px;line-height:1.45;margin:6px 0 14px 0;text-align:center;word-break:break-word;}
  footer.note{margin-top:14px;color:#666;font-size:13px;}
  #dominantMessage{margin-top:20px;background:#f8f8f8;border-radius:12px;padding:16px;color:#333;font-size:15px;line-height:1.4;box-shadow:0 6px 20px rgba(0,0,0,0.04);}
  #dominantMessage strong{color:var(--accent);}
  @media (max-width:520px){ .panel{padding:20px;} #questionText{font-size:16px;} .btn{padding:10px 20px;} }
</style>
</head>
<body>
<div class="wrap">
  <div class="panel" id="panel">

    <!-- Landing Page -->
    <div id="landingPane">
      <h1 id="pageTitle">Spectrum of Awareness</h1>
      <div class="row" id="langRow">
        <select id="langSelect">
          <option value="en">English</option>
          <option value="de">Deutsch</option>
          <option value="fa">فارسی</option>
        </select>
      </div>
      <p class="lead" id="landingText">This is a reflection of my inner consciousness called Spectrum of Awareness.</p>
      <button id="startBtn" class="btn">Start</button>
    </div>

    <!-- Questionnaire Page -->
    <div id="questionPane" class="hidden">
      <div id="questionText"></div>
      <div class="fixed-slider-wrap">
        <div class="fixed-track">
          <input id="questionSlider" type="range" min="0" max="10" value="5" />
        </div>
        <div class="slider-labels">
          <span id="qLblLeft">Disagree</span>
          <span id="qLblMid">Uncertain</span>
          <span id="qLblRight">Agree</span>
        </div>
      </div>
      <button id="nextBtn" class="btn">Next</button>
    </div>

    <!-- Result Page -->
    <div id="resultPane" class="hidden">
      <h1 id="resultTitle">Spectrum of Awareness</h1>
      <div class="result-grid">
        <div class="result-stage" id="stageI"><div>Stage I</div><div class="result-score" id="scoreI">0.0</div></div>
        <div class="result-stage" id="stageII"><div>Stage II</div><div class="result-score" id="scoreII">0.0</div></div>
        <div class="result-stage" id="stageIII"><div>Stage III</div><div class="result-score" id="scoreIII">0.0</div></div>
      </div>
      <div id="dominantMessage" class="hidden"></div>
      <div id="stageDetails"></div>
      <button id="restartBtn" class="btn">Restart</button>
    </div>

  </div>
</div>

<script>
  
/* ----------------- QUESTIONS ----------------- */

const QUESTIONS = [ 
  {stage:1,en:"Life happens to me.",de:"Das Leben passiert mir.",fa:"زندگی برای من اتفاق می‌افتد."},
  {stage:2,en:"Life happens through me.",de:"Das Leben passiert durch mich.",fa:"زندگی از طریق من اتفاق می‌افتد."},
  {stage:3,en:"Life happens as me.",de:"Das Leben passiert als ich.",fa:"زندگی همان من است که رخ می‌دهد."},

  {stage:1,en:"I feel life is unfair or against me.",de:"Ich fühle, das Leben ist unfair oder gegen mich.",fa:"من احساس می‌کنم زندگی ناعادلانه است یا علیه من است."},
  {stage:2,en:"I notice patterns repeating and wonder why.",de:"Ich bemerke sich wiederholende Muster und frage mich warum.",fa:"من الگوهای تکراری را مشاهده می‌کنم و می‌پرسم چرا."},
  {stage:3,en:"I see all as one flow of consciousness.",de:"Ich sehe alles als einen Fluss des Bewusstseins.",fa:"من همه چیز را به‌عنوان یک جریان واحد آگاهی می‌بینم."},

  {stage:1,en:"I am the victim of life.",de:"Ich bin das Opfer des Lebens.",fa:"من قربانی زندگی هستم."},
  {stage:2,en:"I am connected to a source (higher self, God).",de:"Ich bin mit einer Quelle (höheres Selbst, Gott) verbunden.",fa:"من به یک منبع (خود برتر، خدا) متصل هستم."},
  {stage:3,en:"I am the only source; God is a concept within me.",de:"Ich bin die einzige Quelle; Gott ist ein Konzept in mir.",fa:"من تنها منبع هستم؛ خدا مفهومی درون من است."},

  {stage:1,en:"I need validation to feel seen.",de:"Ich brauche Bestätigung, um gesehen zu werden.",fa:"من برای دیده شدن به تأیید نیاز دارم."},
  {stage:2,en:"I am validated and seen.",de:"Ich bin bestätigt und gesehen.",fa:"من تأیید و دیده شده‌ام."},
  {stage:3,en:"I am the only validation.",de:"Ich bin die einzige Bestätigung.",fa:"من تنها تأیید هستم."},

  {stage:1,en:"I blame society for everything I experience.",de:"Ich gebe der Gesellschaft die Schuld für alles, was ich erlebe.",fa:"من جامعه را برای همه چیز سرزنش می‌کنم."},
  {stage:2,en:"I blame myself for what I experience.",de:"Ich gebe mir selbst die Schuld für das, was ich erlebe.",fa:"من خودم را برای تجربه‌هایم سرزنش می‌کنم."},
  {stage:3,en:"I blame no one; all arises from me.",de:"Ich gebe niemandem die Schuld; alles entsteht aus mir.",fa:"من کسی را سرزنش نمی‌کنم؛ همه چیز از من برمی‌خیزد."},

  {stage:1,en:"I feel disconnected or unseen.",de:"Ich fühle mich getrennt oder ungesehen.",fa:"من احساس جدایی یا نادیده گرفته شدن می‌کنم."},
  {stage:2,en:"I feel glimpses of unity and flow.",de:"Ich spüre Momente der Einheit und des Flusses.",fa:"من لحظاتی از وحدت و جریان را تجربه می‌کنم."},
  {stage:3,en:"I live without striving; I am being.",de:"Ich lebe ohne Anstrengung; ich bin.",fa:"من بدون تلاش زندگی می‌کنم؛ من هستم."},

  {stage:1,en:"I was created.",de:"Ich wurde erschaffen.",fa:"من خلق شده‌ام."},
  {stage:2,en:"I am questioning creation.",de:"Ich hinterfrage die Schöpfung.",fa:"من در مورد خلقت سؤال می‌کنم."},
  {stage:3,en:"I am the only creator.",de:"Ich bin der einzige Schöpfer.",fa:"من تنها خالق هستم."},

  {stage:1,en:"There is someone or something out there.",de:"Da ist jemand oder etwas da draußen.",fa:"کسی یا چیزی در بیرون وجود دارد."},
  {stage:2,en:"Is there anyone out there?",de:"Gibt es jemanden da draußen?",fa:"آیا کسی در بیرون هست؟"},
  {stage:3,en:"There is no one; only I experience myself.",de:"Es ist niemand da; nur ich erlebe mich selbst.",fa:"هیچ‌کس نیست؛ تنها من خودم را تجربه می‌کنم."},

  {stage:1,en:"Someone has built the wall.",de:"Jemand hat die Mauer gebaut.",fa:"کسی دیوار را ساخته است."},
  {stage:2,en:"I am a brick in the wall.",de:"Ich bin ein Ziegel in der Mauer.",fa:"من یک آجر در دیوار هستم."},
  {stage:3,en:"I am the wall, shaping it constantly.",de:"Ich bin die Mauer, die sie ständig formt.",fa:"من دیوار هستم و آن را دائماً شکل می‌دهم."},

  {stage:1,en:"Somebody has built the road.",de:"Jemand hat die Straße gebaut.",fa:"کسی جاده را ساخته است."},
  {stage:2,en:"Who built the road?",de:"Wer hat die Straße gebaut?",fa:"چه کسی جاده را ساخته است؟"},
  {stage:3,en:"As I walk, the road appears; all is my creation.",de:"Während ich gehe, erscheint die Straße; alles ist meine Schöpfung.",fa:"همان‌طور که راه می‌روم، جاده ظاهر می‌شود؛ همه چیز خلق من است."},

  {stage:1,en:"I feel powerless to change what happens.",de:"Ich fühle mich machtlos, das Geschehen zu ändern.",fa:"من قدرت تغییر آنچه اتفاق می‌افتد را ندارم."},
  {stage:2,en:"I am the change; I need to act.",de:"Ich bin die Veränderung; ich muss handeln.",fa:"من تغییر هستم؛ باید عمل کنم."},
  {stage:3,en:"I hold no resistance; all is perfectly aligned with me.",de:"Ich widerstehe nichts; alles ist perfekt mit mir ausgerichtet.",fa:"من هیچ مقاومتی ندارم؛ همه چیز کاملاً با من هماهنگ است."},

  {stage:1,en:"I believe luck or fate decides outcomes.",de:"Ich glaube, Glück oder Schicksal entscheidet die Ergebnisse.",fa:"من باور دارم شانس یا سرنوشت نتایج را تعیین می‌کند."},
  {stage:2,en:"I trust life more than I resist it.",de:"Ich vertraue dem Leben mehr, als dass ich Widerstand leiste.",fa:"من به زندگی بیشتر از مقاومت اعتماد می‌کنم."},
  {stage:3,en:"I radiate fairness; all outcomes flow through me.",de:"Ich strahle Gerechtigkeit aus; alle Ergebnisse fließen durch mich.",fa:"من عدالت می‌تابانم؛ همه نتایج از طریق من جریان دارند."},

  {stage:1,en:"I see others as separate beings on their own journey.",de:"Ich sehe andere als separate Wesen auf ihrem eigenen Weg.",fa:"من دیگران را موجودات جداگانه در مسیر خود می‌بینم."},
  {stage:2,en:"I see others as mirrors, reflecting and teaching me.",de:"Ich sehe andere als Spiegel, die mich reflektieren und lehren.",fa:"من دیگران را به‌عنوان آیینه‌ای می‌بینم که بازتاب می‌دهند و به من آموزش می‌دهند."},
  {stage:3,en:"I see others only as shadows I create; only characters I allow.",de:"Ich sehe andere nur als Schatten, die ich erschaffe; nur Figuren, die ich erlaube.",fa:"من دیگران را تنها به‌عنوان سایه‌هایی که خلق می‌کنم می‌بینم؛ فقط شخصیت‌هایی که اجازه می‌دهم."},

  {stage:1,en:"I fear losing control.",de:"Ich habe Angst, die Kontrolle zu verlieren.",fa:"من از دست دادن کنترل می‌ترسم."},
  {stage:2,en:"I see no separation between creation and creator.",de:"Ich sehe keine Trennung zwischen Schöpfung und Schöpfer.",fa:"من جدایی بین خلق و خالق را نمی‌بینم."},
  {stage:3,en:"There are no others; only I experience my creation.",de:"Es gibt keine anderen; nur ich erlebe meine Schöpfung.",fa:"هیچ دیگری وجود ندارد؛ تنها من خلق خود را تجربه می‌کنم."},

  {stage:1,en:"There is God.",de:"Es gibt Gott.",fa:"خدا وجود دارد."},
  {stage:2,en:"Is there a God?",de:"Gibt es einen Gott?",fa:"آیا خدایی وجود دارد؟"},
  {stage:3,en:"There is no God; only I exist.",de:"Es gibt keinen Gott; nur ich existiere.",fa:"خدایی وجود ندارد؛ تنها من هستم."},

  {stage:1,en:"I need to belong to feel whole.",de:"Ich muss dazugehören, um mich vollständig zu fühlen.",fa:"من نیاز دارم تعلق داشته باشم تا کامل باشم."},
  {stage:2,en:"I am not alone; I belong.",de:"Ich bin nicht allein; ich gehöre dazu.",fa:"من تنها نیستم؛ تعلق دارم."},
  {stage:3,en:"I am alone; the only one.",de:"Ich bin allein; der Einzige.",fa:"من تنها هستم؛ تنها یک موجود."},

  {stage:1,en:"I often compare myself to others.",de:"Ich vergleiche mich oft mit anderen.",fa:"من اغلب خود را با دیگران مقایسه می‌کنم."},
  {stage:2,en:"I recognize reflections in others.",de:"Ich erkenne Spiegelungen in anderen.",fa:"من بازتاب‌ها را در دیگران تشخیص می‌دهم."},
  {stage:3,en:"I know love as my natural state.",de:"Ich kenne Liebe als meinen natürlichen Zustand.",fa:"من عشق را به‌عنوان حالت طبیعی خود می‌شناسم."},

  {stage:1,en:"I think peace depends on circumstances.",de:"Ich glaube, Frieden hängt von den Umständen ab.",fa:"من فکر می‌کنم صلح به شرایط بستگی دارد."},
  {stage:2,en:"I begin to see love behind appearances.",de:"Ich beginne, Liebe hinter Erscheinungen zu sehen.",fa:"من شروع می‌کنم عشق پشت ظاهرها را ببینم."},
  {stage:3,en:"I am love observing myself.",de:"Ich bin die Liebe, die sich selbst beobachtet.",fa:"من عشق هستم که خود را مشاهده می‌کنم."},

  {stage:1,en:"I hold resentment or blame.",de:"Ich hege Groll oder Schuldgefühle.",fa:"من دلخوری یا سرزنش دارم."},
  {stage:2,en:"I begin forgiving and letting go.",de:"Ich beginne zu vergeben und loszulassen.",fa:"من شروع می‌کنم به بخشیدن و رها کردن."},
  {stage:3,en:"I understand nothing is missing; all is integrated in me.",de:"Ich verstehe, dass nichts fehlt; alles ist in mir integriert.",fa:"من می‌فهمم هیچ چیزی کم نیست؛ همه چیز در من یکپارچه است."},

  {stage:1,en:"There is hell and heaven.",de:"Es gibt Himmel und Hölle.",fa:"جهنم و بهشت وجود دارد."},
  {stage:2,en:"Hell and heaven are states of being.",de:"Himmel und Hölle sind Zustände des Seins.",fa:"جهنم و بهشت حالت‌های هستی هستند."},
  {stage:3,en:"There is no hell or heaven; only I experience myself.",de:"Es gibt kein Himmel oder Hölle; nur ich erlebe mich selbst.",fa:"هیچ جهنم یا بهشتی وجود ندارد؛ تنها من خودم را تجربه می‌کنم."},

  {stage:1,en:"There is always someone to blame for events or my experience.",de:"Es gibt immer jemanden, dem man die Schuld geben kann.",fa:"همیشه کسی برای سرزنش وجود دارد."},
  {stage:2,en:"I only blame myself for what I experience.",de:"Ich gebe nur mir selbst die Schuld für das, was ich erlebe.",fa:"من تنها خودم را برای آنچه تجربه می‌کنم سرزنش می‌کنم."},
  {stage:3,en:"I blame no one; all arises from me.",de:"Ich gebe niemandem die Schuld; alles entsteht aus mir.",fa:"من کسی را سرزنش نمی‌کنم؛ همه چیز از من برمی‌خیزد."},

  {stage:1,en:"I need to be acknowledged.",de:"Ich muss anerkannt werden.",fa:"من نیاز دارم که به رسمیت شناخته شوم."},
  {stage:2,en:"I question whether acknowledgement matters.",de:"Ich hinterfrage, ob Anerkennung wichtig ist.",fa:"من می‌پرسم آیا به رسمیت شناختن مهم است؟"},
  {stage:3,en:"I am acknowledgement.",de:"Ich bin Anerkennung.",fa:"من خودم رسمیت هستم."},

  {stage:1,en:"I am constantly judging others.",de:"Ich urteile ständig über andere.",fa:"من مدام دیگران را قضاوت می‌کنم."},
  {stage:2,en:"I try not to judge, but I judge myself.",de:"Ich versuche nicht zu urteilen, aber ich urteile über mich selbst.",fa:"من سعی می‌کنم قضاوت نکنم، اما خودم را قضاوت می‌کنم."},
  {stage:3,en:"There is no judgment.",de:"Es gibt kein Urteil.",fa:"قضاوتی وجود ندارد."},

  {stage:1,en:"There is a history before me.",de:"Es gibt eine Geschichte vor mir.",fa:"تاریخی قبل از من وجود دارد."},
  {stage:2,en:"I think there is a source giving all beings consciousness.",de:"Ich erkenne, dass es eine Quelle gibt, die allen Wesen Bewusstsein verleiht.",fa:"من می‌دانم منبعی وجود دارد که به همه موجودات آگاهی می‌دهد."},
  {stage:3,en:"Time is an illusion; everything is in the now.",de:"Zeit ist eine Illusion; alles existiert im Jetzt.",fa:"زمان توهم است؛ همه چیز در اکنون است."},

  {stage:1,en:"Life is being projected to me.",de:"Das Leben wird mir projiziert.",fa:"زندگی برای من تجسم می‌شود."},
  {stage:2,en:"Reality is a co-creation; I am projecting and being projected.",de:"Die Realität ist eine Mit-Schöpfung; ich projiziere und werde projiziert.",fa:"واقعیت یک هم‌آفرینی است؛ من پروژه می‌کنم و پروژه می‌شوم."},
  {stage:3,en:"Let there be light; I only project my thoughts and feelings.",de:"Es werde Licht; ich projiziere nur meine Gedanken und Gefühle.",fa:"بگذار نور باشد؛ من فقط افکار و احساسات خود را تجسم می‌کنم."},

  {stage:1,en:"I perceive reality as external and separate from me.",de:"Ich nehme die Realität als extern und getrennt von mir wahr.",fa:"من واقعیت را جدا و بیرونی نسبت به خود می‌بینم."},
  {stage:2,en:"I recognize that my perception shapes what I call reality.",de:"Ich erkenne, dass meine Wahrnehmung formt, was ich Realität nenne.",fa:"من می‌دانم که ادراک من آنچه واقعیت می‌نامم را شکل می‌دهد."},
  {stage:3,en:"All reality is my own consciousness; I am both observer and observed.",de:"Alle Realität ist mein eigenes Bewusstsein; ich bin Beobachter und Beobachtetes.",fa:"همه واقعیت آگاهی خود من است؛ من هم ناظر و هم مشاهده‌شده هستم."},

  {stage:1,en:"I am influenced by past experiences and patterns.",de:"Ich bin von vergangenen Erfahrungen und Mustern beeinflusst.",fa:"من تحت تأثیر تجربیات و الگوهای گذشته هستم."},
  {stage:2,en:"I see the threads of causality and my participation in them.",de:"Ich sehe die Fäden der Kausalität und meine Beteiligung daran.",fa:"من تارهای علیت و مشارکت خود را در آنها می‌بینم."},
  {stage:3,en:"I am timeless; all causes and effects are me, fully present.",de:"Ich bin zeitlos; alle Ursachen und Wirkungen sind ich, vollständig präsent.",fa:"من بی‌زمان هستم؛ همه علل و معلول‌ها من هستم، کاملاً حاضر."},

  {stage:1,en:"I seek answers outside myself.",de:"Ich suche Antworten außerhalb von mir.",fa:"من دنبال پاسخ بیرون از خودم می‌گردم."},
  {stage:2,en:"I begin to find truth within my own awareness.",de:"Ich beginne, Wahrheit in meinem eigenen Bewusstsein zu finden.",fa:"من شروع به یافتن حقیقت در آگاهی خود می‌کنم."},
  {stage:3,en:"All knowing arises within me; there is no outside, only insight.",de:"Alles Wissen entsteht in mir.",fa:"همه دانایی درون من پدید می‌آید؛ هیچ بیرونی وجود ندارد، فقط بینش است."},

  {stage:1,en:"I feel bound by limitations of body and mind.",de:"Ich fühle mich durch Körper- und Geistesgrenzen gebunden.",fa:"من محدود به محدودیت‌های بدن و ذهن هستم."},
  {stage:2,en:"I sense the expansion beyond perceived limits.",de:"Ich spüre die Ausdehnung über wahrgenommene Grenzen hinaus.",fa:"من گسترش فراتر از مرزهای درک‌شده را حس می‌کنم."},
  {stage:3,en:"I exist beyond all limitations; I am infinite presence.",de:"Ich existiere jenseits aller Begrenzungen; ich bin unendliche Präsenz.",fa:"من فراتر از همه محدودیت‌ها وجود دارم؛ من حضور بی‌نهایت هستم."},

  {stage:1,en:"I judge and label what I experience.",de:"Ich urteile und etikettiere, was ich erfahre.",fa:"من تجربه‌هایم را قضاوت و برچسب می‌زنم."},
  {stage:2,en:"I witness my judgments and release them.",de:"Ich beobachte meine Urteile und lasse sie los.",fa:"من قضاوت‌های خود را مشاهده می‌کنم و رها می‌کنم."},
  {stage:3,en:"I am the pure witness; all distinctions are reflections of my own mind.",de:"Ich bin der reine Zeuge; alle Unterschiede sind Spiegelungen meines eigenen Geistes.",fa:"من شاهد مطلق هستم؛ همه تمایزات بازتاب ذهن خودم هستند."}
];
const STAGE_SUMMARY = {
  1:{en:"Stage I — Victimhood: experiencing life as happening to you.",de:"Stufe I — Opferrolle: das Leben geschieht dir.",fa:"مرحله I — قربانی: زندگی را به‌عنوان چیزی که بر تو رخ می‌دهد تجربه می‌کنی."},
  2:{en:"Stage II — Awareness: awakening to patterns and flow.",de:"Stufe II — Bewusstsein: Erwachen zu Mustern und Fluss.",fa:"مرحله II — آگاهی: بیداری نسبت به الگوها و جریان."},
  3:{en:"Stage III — Mastery: life flows as you, effortlessly.",de:"Stufe III — Meisterschaft: das Leben fließt mühelos als du.",fa:"مرحله III — تسلط: زندگی بی‌تلاش به‌عنوان تو جریان دارد."}
};
let currentLang="en",scores={1:0,2:0,3:0},currentQuestionIndex=0,shuffledQuestions=[];
const landingPane=document.getElementById("landingPane"),questionPane=document.getElementById("questionPane"),resultPane=document.getElementById("resultPane");
const questionText=document.getElementById("questionText"),slider=document.getElementById("questionSlider");
const scoreI=document.getElementById("scoreI"),scoreII=document.getElementById("scoreII"),scoreIII=document.getElementById("scoreIII");
const domMsg=document.getElementById("dominantMessage");
document.getElementById("langSelect").onchange=e=>{currentLang=e.target.value;document.documentElement.setAttribute('dir',currentLang==="fa"?"rtl":"ltr");};
document.getElementById("startBtn").onclick=()=>{landingPane.classList.add("hidden");questionPane.classList.remove("hidden");shuffledQuestions=QUESTIONS.sort(()=>Math.random()-0.5);scores={1:0,2:0,3:0};currentQuestionIndex=0;renderQuestion();};
document.getElementById("nextBtn").onclick=()=>{scores[shuffledQuestions[currentQuestionIndex].stage]+=+slider.value;if(++currentQuestionIndex>=shuffledQuestions.length)showResults();else renderQuestion();};
document.getElementById("restartBtn").onclick=()=>{resultPane.classList.add("hidden");landingPane.classList.remove("hidden");domMsg.classList.add("hidden");domMsg.textContent="";};
function renderQuestion(){const q=shuffledQuestions[currentQuestionIndex];questionText.textContent=q[currentLang];slider.value=5;}
function showResults(){
  questionPane.classList.add("hidden");resultPane.classList.remove("hidden");
  const counts={1:0,2:0,3:0};for(const q of QUESTIONS)counts[q.stage]++;
  scoreI.textContent=(scores[1]/counts[1]).toFixed(1);
  scoreII.textContent=(scores[2]/counts[2]).toFixed(1);
  scoreIII.textContent=(scores[3]/counts[3]).toFixed(1);
  showDominant();
}
function showDominant(){
  const avg1=+scoreI.textContent,avg2=+scoreII.textContent,avg3=+scoreIII.textContent;
  let dom=1;if(avg2>=avg1&&avg2>=avg3)dom=2;if(avg3>=avg1&&avg3>=avg2)dom=3;
  domMsg.textContent=STAGE_SUMMARY[dom][currentLang];
  domMsg.classList.remove("hidden");
}
  
/* ----------------- STAGE INFO ----------------- */
const STAGE_INFO = [
  {title:{en:"Stage I — Victimhood",de:"Stufe I — Opferrolle",fa:"مرحله I — قربانی"}, 
   scoreRange:"0–10", 
   description:{
     en:`Stage I is the realm of victimhood, where the self feels distant from its origin and lost in forgetfulness. Life is experienced as happening to the self rather than through it.
• Score close to 10: Deep immersion in victimhood; heavy attachment, resistance, and identification with external stories. Overall state dominated by Stage I.
• Score around 5: Partial awareness emerging; glimpses of truth appear, potential to move toward Stage II.
• Score below 5: Early awakening; self begins noticing patterns and reflections. Shadow work and self-inquiry required.`,
     de:`Stufe I ist das Reich der Opferrolle, in dem das Selbst sich von seiner Quelle entfernt und in Vergessenheit verloren fühlt. Das Leben wird erlebt, als geschähe es dem Selbst, nicht durch das Selbst.
• Nähe zu 10: Tiefe Opferhaltung; starke Bindung, Widerstand und Identifikation mit äußeren Geschichten. Gesamtzustand von Stufe I dominiert.
• Um 5: Teilweise aufkommendes Bewusstsein; Einblicke erscheinen, Potenzial für Stufe II.
• Unter 5: Frühes Erwachen; das Selbst bemerkt Muster und Spiegelungen. Schattenarbeit und Selbstreflexion erforderlich.`,
     fa:`مرحله I حوزه قربانی بودن است که در آن خود احساس دوری از منبع خود دارد و در فراموشی گم شده است. زندگی به‌عنوان چیزی که بر خود رخ می‌دهد تجربه می‌شود، نه از طریق آن.
• نزدیک ۱۰: غرق شدن در قربانی بودن؛ وابستگی شدید، مقاومت و هویت با داستان‌های بیرونی.
• حدود ۵: آگاهی جزئی ظاهر می‌شود؛ درک‌هایی از حقیقت نمایان می‌شود، پتانسیل حرکت به سمت مرحله II.
• زیر ۵: بیداری اولیه؛ خود الگوها و بازتاب‌ها را متوجه می‌شود. نیاز به کار سایه و خودکاوی.` }},
  {title:{en:"Stage II — Awareness",de:"Stufe II — Bewusstsein",fa:"مرحله II — آگاهی"}, 
   scoreRange:"0–10", 
   description:{
     en:`Stage II is the awakening stage. The self begins noticing patterns, understanding its role as a co-creator, and feeling connected to a greater flow. Awareness increases and judgment diminishes.
• Score close to 10: High awareness, conscious decision-making; beginning integration of shadow and light.
• Score around 5: Growing insight; self is partially aware of patterns and influences.
• Score below 5: Early awareness; self notices repetition, questioning begins.`,
     de:`Stufe II ist die Erwachensstufe. Das Selbst beginnt Muster zu erkennen, seine Rolle als Mit-Schöpfer zu verstehen und sich mit einem größeren Fluss verbunden zu fühlen. Bewusstsein steigt, Urteilskraft nimmt ab.
• Nähe zu 10: Hohes Bewusstsein, bewusstes Entscheiden; Beginn der Integration von Schatten und Licht.
• Um 5: Wachsende Einsicht; das Selbst ist teilweise sich der Muster bewusst.
• Unter 5: Frühes Bewusstsein; das Selbst bemerkt Wiederholungen, Fragen beginnen.`,
     fa:`مرحله II مرحله بیداری است. خود شروع به مشاهده الگوها، درک نقش خود به‌عنوان هم‌آفریننده و احساس ارتباط با جریان بزرگتر می‌کند. آگاهی افزایش می‌یابد و قضاوت کاهش می‌یابد.
• نزدیک ۱۰: آگاهی بالا، تصمیم‌گیری آگاهانه؛ شروع یکپارچه‌سازی سایه و نور.
• حدود ۵: بینش در حال رشد؛ خود تا حدی از الگوها و تأثیرات آگاه است.
• زیر ۵: آگاهی اولیه؛ خود تکرارها را می‌بیند، پرسش‌ها آغاز می‌شوند.` }},
  {title:{en:"Stage III — Mastery",de:"Stufe III — Meisterschaft",fa:"مرحله III — تسلط"}, 
   scoreRange:"0–10", 
   description:{
     en:`Stage III is the stage of mastery and full integration. The self knows it is the only source; all experiences are reflections of inner consciousness. There is no separation, only pure creation.
• Score close to 10: Complete embodiment of mastery; life flows effortlessly through the self.
• Score around 5: Integration in progress; glimpses of mastery and unity appear.
• Score below 5: Early mastery signs; self experiments with full ownership and creation.`,
     de:`Stufe III ist die Stufe der Meisterschaft und vollständigen Integration. Das Selbst erkennt, dass es die einzige Quelle ist; alle Erfahrungen sind Spiegelungen des inneren Bewusstseins. Keine Trennung, nur reine Schöpfung.
• Nähe zu 10: Vollständige Verkörperung der Meisterschaft; das Leben fließt mühelos durch das Selbst.
• Um 5: Integration im Gange; Einblicke in Meisterschaft und Einheit erscheinen.
• Unter 5: Frühe Meisterschaftsanzeichen; das Selbst experimentiert mit voller Verantwortung und Schöpfung.`,
     fa:`مرحله III مرحله تسلط و یکپارچگی کامل است. خود می‌داند که تنها منبع است؛ همه تجربه‌ها بازتاب آگاهی درونی هستند. هیچ جدایی وجود ندارد، فقط خلق خالص.
• نزدیک ۱۰: تجسم کامل تسلط؛ زندگی به‌راحتی از طریق خود جریان می‌یابد.
• حدود ۵: یکپارچه‌سازی در حال انجام؛ درک‌هایی از تسلط و وحدت ظاهر می‌شود.
• زیر ۵: نشانه‌های اولیه تسلط؛ خود با مالکیت کامل و خلق آزمایش می‌کند.` }}
];

/* ----------------- LANGUAGE CONTROL ----------------- */
let currentLang = "en";
const langSelect = document.getElementById("langSelect");
langSelect.addEventListener("change",(e)=>{currentLang=e.target.value;updateLanguage();});

function updateLanguage(){
  document.documentElement.setAttribute('dir', currentLang==="fa"?"rtl":"ltr");
  const langTexts = {
    landingTitle: {en:"Spectrum of Awareness",de:"Spektrum des Bewusstseins",fa:"طیف آگاهی"},
    landingText:{en:"This is a reflection of my inner consciousness called Spectrum of Awareness. I am answering a series of statements using the slider to indicate my agreement.",
                 de:"Dies ist eine Reflexion meines inneren Bewusstseins namens Spektrum des Bewusstseins. Ich beantworte eine Reihe von Aussagen mit dem Schieberegler, um meine Zustimmung anzuzeigen.",
                 fa:"این بازتابی از آگاهی درونی من است به نام طیف آگاهی. من به مجموعه‌ای از جملات پاسخ می‌دهم و با نوار لغزنده میزان توافق خود را نشان می‌دهم."},
    startBtn:{en:"Start",de:"Start",fa:"شروع"},
    nextBtn:{en:"Next",de:"بعدی",fa:"بعدی"},
    restartBtn:{en:"Restart",de:"Neustart",fa:"شروع مجدد"},
    qLblLeft:{en:"Disagree",de:"Nicht einverstanden",fa:"مخالفم"},
    qLblMid:{en:"Uncertain",de:"Unsicher",fa:"نامطمئن"},
    qLblRight:{en:"Agree",de:"Einverstanden",fa:"موافقم"},
    resultTitle:{en:"Spectrum of Awareness",de:"Spektrum des Bewusstseins",fa:"طیف آگاهی"}
  };
  document.getElementById("pageTitle").textContent = langTexts.landingTitle[currentLang];
  document.getElementById("landingText").textContent = langTexts.landingText[currentLang];
  document.getElementById("startBtn").textContent = langTexts.startBtn[currentLang];
  document.getElementById("nextBtn").textContent = langTexts.nextBtn[currentLang];
  document.getElementById("restartBtn").textContent = langTexts.restartBtn[currentLang];
  document.getElementById("qLblLeft").textContent = langTexts.qLblLeft[currentLang];
  document.getElementById("qLblMid").textContent = langTexts.qLblMid[currentLang];
  document.getElementById("qLblRight").textContent = langTexts.qLblRight[currentLang];
  document.getElementById("resultTitle").textContent = langTexts.resultTitle[currentLang];
  renderQuestion();
}

/* ----------------- NAVIGATION ----------------- */
const landingPane = document.getElementById("landingPane");
const questionPane = document.getElementById("questionPane");
const resultPane = document.getElementById("resultPane");
const startBtn = document.getElementById("startBtn");
const nextBtn = document.getElementById("nextBtn");
const restartBtn = document.getElementById("restartBtn");
startBtn.addEventListener("click",startTest);
nextBtn.addEventListener("click",nextQuestion);
restartBtn.addEventListener("click",restartTest);

let shuffledQuestions = [];
let currentQuestionIndex = 0;
let scores = {1:0,2:0,3:0};

function startTest(){
  landingPane.classList.add("hidden");
  questionPane.classList.remove("hidden");
  resultPane.classList.add("hidden");
  shuffledQuestions = QUESTIONS.sort(()=>Math.random()-0.5);
  currentQuestionIndex=0;
  scores={1:0,2:0,3:0};
  renderQuestion();
}

function nextQuestion(){
  const val = parseInt(document.getElementById("questionSlider").value);
  const qStage = shuffledQuestions[currentQuestionIndex].stage;
  scores[qStage]+=val;
  currentQuestionIndex++;
  if(currentQuestionIndex>=shuffledQuestions.length){
    showResults();
  } else {
    renderQuestion();
  }
}

function restartTest(){
  landingPane.classList.remove("hidden");
  questionPane.classList.add("hidden");
  resultPane.classList.add("hidden");
  langSelect.value=currentLang;
  updateLanguage();
}

/* ----------------- RENDER QUESTION ----------------- */
function renderQuestion(){
  if(questionPane.classList.contains("hidden")) return;
  const q = shuffledQuestions[currentQuestionIndex];
  document.getElementById("questionText").textContent = q[currentLang];
  document.getElementById("questionSlider").value = 5;
}

/* ----------------- RESULTS ----------------- */
function showResults(){
  questionPane.classList.add("hidden");
  resultPane.classList.remove("hidden");

  // calculate average per stage
  const countPerStage = {1:0,2:0,3:0};
  for(const q of QUESTIONS) countPerStage[q.stage]++;
  document.getElementById("scoreI").textContent = (scores[1]/countPerStage[1]).toFixed(1);
  document.getElementById("scoreII").textContent = (scores[2]/countPerStage[2]).toFixed(1);
  document.getElementById("scoreIII").textContent = (scores[3]/countPerStage[3]).toFixed(1);

  renderStageDetails();
}

/* ----------------- STAGE DETAILS ----------------- */
const stageElements = {
  1: document.getElementById("stageI"),
  2: document.getElementById("stageII"),
  3: document.getElementById("stageIII")
};

for(let s=1;s<=3;s++){
  stageElements[s].addEventListener("click",()=>showStageDesc(s));
}

function renderStageDetails(){
  document.getElementById("stageDetails").innerHTML = "";
}

function showStageDesc(stageNum){
  const stage = STAGE_INFO[stageNum-1];
  const descContainer = document.getElementById("stageDetails");
  descContainer.innerHTML = `
    <div class="stage-desc">
      <span class="close-btn" onclick="this.parentElement.style.display='none'">&times;</span>
      <h3>${stage.title[currentLang]}</h3>
      <p>${stage.description[currentLang]}</p>
    </div>
  `;
  descContainer.querySelector(".stage-desc").style.display="block";
}

/* ----------------- INIT ----------------- */
updateLanguage();
</script>
</body>
</html>
